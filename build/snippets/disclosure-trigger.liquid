{% doc %}
  Disclosure Trigger Component

  Renders a button that controls a disclosure/collapsible content area.
  Includes proper ARIA attributes for accessibility.

  @param is_expanded - {Boolean} Whether the disclosure is currently expanded
  @param controls_id - {String} ID of the element this button controls
  @param disclosure_name - {String} Translation key for the disclosure name
  @param label_text - {String} Translation key for the button label
  @param label_bubble_text - {String} ......

  @example
  {% render 'disclosure-trigger',
    controls_id: 'cart-discount-disclosure',
    is_expanded: discount_codes.size > 0,
    disclosure_name: 'cart.discount_code',
    label_text: 'content.discount',
    label_bubble_text: ''
  %}
{% enddoc %}

<button
  aria-controls="{{ controls_id }}"
  aria-expanded="{% if is_expanded %}true{% else %}false{% endif %}"
  aria-label="{% if is_expanded %}{{ 'actions.close' | t }}{% else %}{{ 'actions.open' | t }}{% endif %} {{ disclosure_name | t }}"
  class="disclosure-trigger"
  data-disclosure-open="{{ 'actions.open' | t }} {{ disclosure_name | t }}"
  data-disclosure-close="{{ 'actions.close' | t }} {{ disclosure_name | t }}"
  on:click="/toggleDisclosure"
  ref="disclosureTrigger"
  type="button"
>
  <span class="disclosure-trigger__label h6">
    <span>{{ label_text | t }}</span>
    {% if label_bubble_text and label_bubble_text > 0 %}
      <span class="disclosure-trigger__label-bubble">{{ label_bubble_text }}</span>
    {% endif %}
  </span>

  <span class="svg-wrapper icon-plus">
    {{- 'icon-plus.svg' | inline_asset_content -}}
  </span>
</button>

{% stylesheet %}
  .disclosure-trigger {
    cursor: pointer;
    color: var(--color-foreground);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-block: var(--padding-sm);
    padding-inline: 0;
    width: 100%;
    border: none;
    background: #0000;

    &[aria-expanded='true'] .horizontal {
      rotate: 90deg;
    }

    &:is(:hover, :focus-visible) {
      color: rgb(var(--color-foreground-rgb) / var(--opacity-subdued-text));
    }

    .horizontal {
      transform-box: fill-box;
      transform-origin: center;
    }

    svg {
      aspect-ratio: 1;
      width: var(--icon-size-xs);
    }
  }

  .disclosure-trigger__label {
    display: flex;
    align-items: center;
    gap: var(--gap-xs);
    font-size: var(--cart-font-size--sm);
  }

  .disclosure-trigger__label-bubble {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 20px;
    height: 20px;
    overflow: hidden;
    color: var(--color-background);
    background-color: var(--color-foreground);
    border-radius: var(--style-border-radius-50);
    font-family: var(--font-paragraph--family);
    font-weight: var(--font-paragraph--weight);
    font-size: var(--font-size--2xs);
    line-height: 1;
  }

  @media (prefers-reduced-motion: no-preference) {
    .disclosure-trigger .horizontal {
      transition: rotate var(--surface-transition-duration) var(--surface-transition-timing);
    }
  }
{% endstylesheet %}
